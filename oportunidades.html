<!-- flag15 -->
<!-- checkpoint: 2025-10-15-landing-1 -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Oportunidades | Sapiens Digital Lab</title>
    <meta name="description" content="Encuentra oportunidades laborales en tecnología, marketing y diseño en Sapiens Digital Lab. Postula y conecta con empresas líderes.">
    <meta name="robots" content="index, follow">
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700&display=swap" rel="stylesheet">
    <style>
    body { background: #fff; }
    
    /* Hero Section */
    .hero { 
        position: relative; 
        background: url('img/bg-oportunidades.png') center/cover no-repeat; 
        min-height: 459px; 
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        justify-content: center; 
        padding: 75px 0 54px 0; 
    }
    .hero__title { 
        font-size: 4.32rem; 
        font-weight: 700; 
        color: #fff; 
        margin: 0 0 11px 0; 
        text-align: center; 
    }
    .hero__subtitle { 
        font-size: 1.89rem; 
        color: #fff; 
        margin: 0 0 32px 0; 
        text-align: center; 
    }
    .hero__buttons { 
        margin: 0; 
        display: flex; 
        gap: 22px; 
        justify-content: center; 
    }
    .hero__buttons img { height: 68px; }
    
    /* Buttons */
    .btn-main { 
        background: url('img/fondo-bt-quierosertalento.png') center/cover no-repeat; 
        border-radius: 6px; 
        padding: 10px 28px; 
        font-size: 1.08rem; 
        font-weight: 400; 
        border: none; 
        color: #fff; 
        cursor: pointer; 
        text-decoration: none; 
        min-width: 100px;
    }
    .btn-main:hover { opacity: 0.9; }
    .btn-main[style*="background:#3AB1C3"] { background: #3AB1C3 !important; }
    
    /* Section Title */
    .section-title { 
        font-size: 2.2rem; 
        font-weight: 700; 
        color: #222; 
        text-align: center; 
        margin: 48px 0 32px 0; 
    }
    

    
    /* Job Cards */
    .cards-list { 
        max-width: 900px; 
        margin: 0 auto 48px auto; 
        display: flex; 
        flex-direction: column; 
        gap: 28px; 
    }
    .job-card { 
        background: #fff; 
        border: 1.5px solid #e5e7eb; 
        border-radius: 18px; 
        box-shadow: none; 
        padding: 0; 
        display: flex; 
        flex-direction: column; 
        position: relative; 
    }
    .job-card-apply-desktop {
        display: none;
    }
    .job-card-apply-mobile {
        display: block;
    }
    .job-card-content { 
        display: flex; 
        align-items: flex-start; 
        gap: 18px; 
        padding: 32px 36px 0 36px; 
        position: relative;
    }
    .job-card-icon { 
        background: #f5f5f5; 
        border-radius: 10px; 
        padding: 8px; 
        display: flex; 
        align-items: center; 
        justify-content: center; 
        height: 48px; 
        width: 48px; 
    }
    .job-card-icon img { height: 32px; width: 32px; }
    .job-card-info {
        flex: 1;
        min-width: 0;
    }
    .job-card-apply { 
        background: url('img/fondosps.png') center/cover no-repeat; 
        color: #fff; 
        border-radius: 6px !important;
        padding: 9px 24px;
        font-size: 0.81rem;
        border: none !important;
        font-weight: 500;
        cursor: pointer;
        text-decoration: none;
        display: block;
        margin: 14px auto 0 auto;
        text-align: center;
        transition: background 0.2s, opacity 0.2s;
        min-width: 105px;
        max-width: 180px;
        z-index: 2;
        /* box-shadow eliminado para quitar efecto de borde */
    }
    @media (max-width: 600px) {
        .job-card-apply-desktop {
            display: none !important;
        }
        .job-card-apply-mobile {
            display: block !important;
            margin-top: 4px !important;
            margin-bottom: 16px !important;
        }
    }
    @media (min-width: 601px) {
        .job-card-apply-desktop {
            display: block;
            position: absolute;
            top: 24px;
            right: 32px;
            margin: 0;
        }
        .job-card-apply-mobile {
            display: none;
        }
    }
    .job-card-apply:hover {
        opacity: 0.9;
        background: #2fa36a;
    }
    .job-card-date { 
        text-align: right; 
        font-size: 0.95rem; 
        color: #aaa; 
        margin: 0 36px 0 0; 
    }
    .job-card-external { 
        position: absolute; 
        top: 20px; 
        right: 20px; 
        color: #bbb; 
        font-size: 1.5rem; 
        display: flex; 
        align-items: center; 
        justify-content: center; 
        z-index: 1; 
    }
    .job-card-external svg { width: 22px; height: 22px; }
    .job-card-title { 
        color: #3AC37B; 
        font-weight: 700; 
        font-size: 1.18rem; 
        margin-bottom: 2px; 
        font-family: inherit;
        font-style: normal;
        font-variation-settings: normal;
    }
    .job-card-location { 
        color: #888; 
        font-size: 0.98rem; 
        margin-bottom: 2px; 
        font-weight: 500;
    }
    
    /* Form Section */
    .form-section { 
        max-width: 1200px; 
        margin: 0 auto 64px auto; 
        display: flex; 
        align-items: flex-start; 
        gap: 48px; 
        padding: 0 16px; 
    }
    .form-img { 
        width: 420px; 
        max-width: 100%; 
        border-radius: 18px; 
        object-fit: cover; 
    }
    .form-fields { 
        flex: 1; 
        display: flex; 
        flex-direction: column; 
        gap: 18px; 
        background: #fff; 
        border-radius: 18px; 
        padding: 32px; 
        border: 1.5px solid #e5e7eb; 
    }
    .form-fields h3 { 
        font-size: 1.5rem; 
        font-weight: 700; 
        margin-bottom: 8px; 
    }
    .input-field { 
        border-radius: 8px; 
        border: 1px solid #ddd; 
        padding: 12px 14px; 
        font-size: 1rem; 
    }
    .form-fields button { 
        background: #3AC37B; 
        color: #fff; 
        border-radius: 18px; 
        padding: 10px 0; 
        font-size: 1.1rem; 
        border: none; 
        font-weight: 600; 
        cursor: pointer; 
        transition: background 0.2s; 
    }
    .form-fields button:hover { background: #2fa36a; }
    
    /* Responsive */
    @media (max-width: 900px) {
        .form-section { 
            flex-direction: column; 
            align-items: stretch; 
            gap: 24px; 
        }
        .form-img { width: 100%; max-width: 100%; }
    }
    @media (max-width: 600px) {
        .hero__title { font-size: 3.2rem; }
        .hero__subtitle { font-size: 1.4rem; }
        .hero__buttons img { height: 50px; }
        .form-fields { padding: 18px 8px; }
        .job-card-actions {
            padding-bottom: 18px;
        }
        .job-card-apply {
            /* Elimina width: 50% para que el botón sea rectangular y consistente */
        }
    }
    @media (min-width: 601px) {
    }
    </style>
</head>
<body>
    <!-- Header igual que index -->
    <header class="header" role="banner">
        <div class="header__logo" style="justify-content: flex-start;">
            <img src="img/logo-sapiens.png" alt="Logo Sapiens Digital Lab" loading="lazy">
        </div>
        <button class="menu-toggle" aria-label="Abrir menú" style="background:none;border:none;outline:none;cursor:pointer;">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
            <rect y="7" width="32" height="3" rx="1.5" fill="#222"/>
            <rect y="14.5" width="32" height="3" rx="1.5" fill="#222"/>
            <rect y="22" width="32" height="3" rx="1.5" fill="#222"/>
          </svg>
        </button>
        <button class="menu-close" aria-label="Cerrar menú" style="background:none;border:none;outline:none;cursor:pointer;display:none;position:fixed;top:16px;right:16px;z-index:10000;font-size:2rem;line-height:1;">
          &times;
        </button>
        <nav class="header__nav" role="navigation" aria-label="Menú principal">
            <ul>
                <li><a href="index.html">Inicio</a></li>
                <li><a href="nosotros.html">Nosotros</a></li>
                <li><a href="oportunidades.html">Oportunidades</a></li>
                <li><a href="contrata-talento.html" class="btn-header"><img src="img/contratatalento.png" alt="Contrata Talento" style="height:38px;vertical-align:middle;"></a></li>
            </ul>
        </nav>
        <div class="mobile-menu" aria-label="Menú móvil" tabindex="-1">
          <ul style="list-style:none;padding:6px 0 4px 0;margin:0;display:flex;flex-direction:column;align-items:flex-start;gap:2px;border:1.5px solid #ddd;border-radius:10px;background:#fff;">
            <li style="margin-bottom:4px;"><img src="img/logo-sapiens.png" alt="Logo Sapiens Digital Lab" style="height:38px;"></li>
            <li><a href="index.html">Inicio</a></li>
            <li><a href="nosotros.html">Nosotros</a></li>
            <li><a href="oportunidades.html">Oportunidades</a></li>
                            <li><a href="contrata-talento.html"><img src="img/contratatalento.png" alt="Contrata Talento" style="height:38px;vertical-align:middle;"></a></li>
          </ul>
        </div>
    </header>
    <!-- Hero -->
    <main id="main-content">
    <section class="hero oportunidades-hero">
        <h1 class="hero__title">Oportunidades</h1>
        <div class="hero__subtitle">Tu futuro profesional ahora</div>
        <div class="hero__buttons">
            <a href="#form-cv"><img src="img/envianosboton.png" alt="Envíanos tu CV" style="height:50px;vertical-align:middle;"></a>
            <a href="https://www.linkedin.com/company/82234284" target="_blank" rel="noopener"><img src="img/siguenosboton.png" alt="Síguenos en LinkedIn" style="height:50px;vertical-align:middle;"></a>
        </div>
    </section>
    
    <!-- Convocatorias activas -->
    <section class="oportunidades-convocatorias">
        <h2 class="section-title">Convocatorias Activas</h2>

        <div id="vacantes-container" class="cards-list">
          <!-- Aquí se llenarán las vacantes dinámicamente con JS -->
        </div>
    </section>
    
    <!-- Formulario de CV -->
    <section class="form-section oportunidades-form" id="form-cv">
        <div class="form-img-wrap">
            <img class="form-img" src="img/form-cv.png" alt="Buscar expertos">
        </div>
        <form class="form-fields" id="cv-form">
            <h3>Envía tu CV</h3>
            <input class="input-field" id="nombre" name="nombre" type="text" placeholder="Nombre" required>
            <input class="input-field" id="apellido" name="apellido" type="text" placeholder="Apellido" required>
            <input class="input-field" id="email" name="email" type="email" placeholder="Correo electrónico" required>
            <input class="input-field" id="especializacion" name="especializacion" type="text" placeholder="Área de especialización (Data, Digital o Agile)" required>
            <input class="input-field" id="linkedin" name="linkedin" type="text" placeholder="Perfil de LinkedIn">
            <button class="btn-main" type="button" id="submit-btn">Enviar</button>
        </form>
    </section>
    </main>
    <!-- Footer igual que index -->
    <div class="footer__bottom" style="position:relative;">
      <div class="footer__content">
        <div class="footer__col footer__contacto">
          <h5>Contacto</h5>
          <div class="footer__contacto-datos">
            <span>Talento@sapiens.la</span>
            <span><a href="https://wa.me/51913804251" target="_blank" rel="noopener" style="color: inherit; text-decoration: underline;">+51 913804251</a></span>
          </div>
        </div>
        <div class="footer__col footer__social-col">
          <h5>Síguenos</h5>
          <div class="footer__social">
            <a href="https://www.linkedin.com/company/sapiens-la" target="_blank"><img src="img/botonlinkedin.png" alt="LinkedIn"></a>
            <a href="https://www.instagram.com/sapiens_la/" target="_blank"><img src="img/bottoning.png" alt="Instagram"></a>
            <a href="https://www.youtube.com/@SapiensDigitalLab" target="_blank"><img src="img/botonyt.png" alt="YouTube"></a>
            <a href="#" target="_blank"><img src="img/botonfb.png" alt="Facebook"></a>
          </div>
        </div>
      </div>
      <img id="scrollToTopBtn" src="img/botonscroll.png" alt="Volver arriba" style="position:absolute; right:20px; top:20px; height:60px; width:60px; cursor:pointer;">
      <span style="display:block; width:100%; text-align:center; margin-top:24px; color:#222;">© 2025 by Sapiens Digital Lab</span>
    </div>
    
    <script>
    document.getElementById('scrollToTopBtn').onclick = function() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    };
    
    // Mobile menu toggle
    const menuToggle = document.querySelector('.menu-toggle');
    const menuClose = document.querySelector('.menu-close');
    const mobileMenu = document.querySelector('.mobile-menu');
    const nav = document.querySelector('.header__nav');
    
    function closeMobileMenu() {
      mobileMenu.style.display = 'none';
      menuClose.style.display = 'none';
      document.body.style.overflow = '';
    }
    
    function openMobileMenu() {
      mobileMenu.style.display = 'block';
      menuClose.style.display = 'block';
      document.body.style.overflow = 'hidden';
    }
    
    menuToggle.addEventListener('click', function() {
      openMobileMenu();
    });
    menuClose.addEventListener('click', function() {
      closeMobileMenu();
    });
    
    // Cerrar menú al hacer clic en un enlace
    mobileMenu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', closeMobileMenu);
    });
    
    // Mostrar/ocultar menú y botones según tamaño
    function handleResize() {
      if (window.innerWidth <= 600) {
        nav.style.display = 'none';
        closeMobileMenu();
      } else {
        nav.style.display = 'block';
        menuClose.style.display = 'none';
        closeMobileMenu();
      }
    }
    
    window.addEventListener('resize', handleResize);
    window.addEventListener('DOMContentLoaded', handleResize);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script>
    // Inicializar EmailJS
    (function() {
      emailjs.init('Q0_hWQQnnmPEqYRwT');
      console.log('EmailJS inicializado correctamente');
    })();
    
    function mostrarPopup(mensaje, esExito) {
      alert(mensaje);
    }
    
    // Cargar vacantes y configurar formulario
    document.addEventListener('DOMContentLoaded', function() {
        // Configurar formulario de CV
        const form = document.getElementById('cv-form');
        const submitBtn = document.getElementById('submit-btn');
        
        if (form && submitBtn) {
            console.log('Formulario encontrado, configurando event listeners');
            
            // Event listener principal al botón
            submitBtn.addEventListener('click', function(e) {
                console.log('Botón clickeado');
                e.preventDefault();
                e.stopPropagation();
                
                // Validar formulario
                const nombre = document.getElementById('nombre').value;
                const apellido = document.getElementById('apellido').value;
                const email = document.getElementById('email').value;
                const especializacion = document.getElementById('especializacion').value;
                
                if (!nombre || !apellido || !email || !especializacion) {
                    alert('Por favor, completa todos los campos requeridos.');
                    return;
                }
                
                // Cambiar el texto del botón mientras se envía
                submitBtn.textContent = 'Enviando...';
                submitBtn.disabled = true;
                
                // Recopilar los datos del formulario
                const formData = {
                    nombre: nombre + ' ' + apellido,
                    email: email,
                    especializacion: especializacion,
                    linkedin: document.getElementById('linkedin').value
                };
                
                console.log('Enviando formulario con datos:', formData);
                
                // Enviar email usando EmailJS con la nueva plantilla para CV
                emailjs.send('service_f73qp8z', 'template_r5k6euu', formData)
                    .then(function(response) {
                        console.log('SUCCESS!', response.status, response.text);
                        mostrarPopup('¡Gracias! Tu CV ha sido enviado exitosamente. Nos pondremos en contacto contigo.', true);
                        form.reset();
                    }, function(error) {
                        console.log('FAILED...', error);
                        mostrarPopup('Ocurrió un error al enviar tu CV. Intenta nuevamente.', false);
                    })
                    .finally(function() {
                        // Restaurar el botón
                        submitBtn.textContent = 'Enviar';
                        submitBtn.disabled = false;
                    });
            });
        }
        
        // ===== Configuración Google Sheets (gviz) =====
        const SHEET_ID = '1LfoeVRmnUdYxHyQLOR4LwOuPFWbRQX4W5rx9N3aUb0Q'; // provisto por el usuario
        const SHEET_NAME = 'vacantes'; // nombre de la hoja (pestaña)

        function buildGvizUrl(sheetId, sheetName) {
          const base = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq`;
          const params = new URLSearchParams({ tqx: 'out:json', sheet: sheetName });
          return `${base}?${params.toString()}`;
        }

        function parseGvizJSON(text) {
          // gviz retorna: "/*O_o*/\ngoogle.visualization.Query.setResponse({...});"
          const marker = 'setResponse(';
          const start = text.indexOf(marker);
          if (start === -1) throw new Error('Respuesta gviz sin setResponse');
          const end = text.lastIndexOf(')');
          if (end === -1 || end <= start) throw new Error('Respuesta gviz sin cierre )');
          const jsonStr = text.substring(start + marker.length, end);
          const data = JSON.parse(jsonStr);
          const table = data.table;
          if (!table || !table.cols || !table.rows) return [];
          const headers = table.cols.map(c => (c && (c.label || c.id) || '').toString().trim());
          const rows = table.rows.map(r => (r.c || []).map(cell => (cell && (cell.v != null ? cell.v : ''))));
          return rows.map(arr => {
            const obj = {};
            headers.forEach((h, i) => {
              if (!h) return;
              const key = h.toString().trim().toLowerCase();
              obj[key] = arr[i] != null ? arr[i] : '';
            });
            return obj;
          });
        }

        function normalizarVacante(v) {
          // Asegurar claves esperadas por el render
          return {
            perfil: v.perfil || v['puesto'] || v['titulo'] || '',
            cliente: v.cliente || v['empresa'] || '',
            ubicacion: v.ubicacion || v['ubicación'] || '',
            modalidad: v.modalidad || '',
            detalle: v.detalle || v['descripcion'] || v['descripción'] || '',
            fecha: v.fecha || '',
            url: v.url || v['link'] || v['enlace'] || '',
            estado: (v.estado || '').toString()
          };
        }

        function renderVacantes(vacantes) {
          const activas = vacantes
            .map(normalizarVacante)
            .filter(v => v.estado && v.estado.toString().trim().toLowerCase() === 'activo');
          const container = document.getElementById('vacantes-container');
          container.innerHTML = '';
          if (activas.length === 0) {
            container.innerHTML = '<p style="text-align:center;">No hay vacantes activas en este momento.</p>';
            return;
          }
          activas.forEach(v => {
            const card = document.createElement('div');
            card.className = 'job-card';
            card.innerHTML = `
              <div class="job-card-content">
                <div class="job-card-icon"><img src="img/icon-job.png" alt="icon"></div>
                <div class="job-card-info">
                  <div class="job-card-title">${v.perfil || ''}</div>
                  <div class="job-card-company">${v.cliente || ''}</div>
                  <div class="job-card-location">${v.ubicacion || ''} | ${v.modalidad || ''}</div>
                  <div class="job-card-desc">${v.detalle || ''}</div>
                  <div class="job-card-date" style="color:#aaa;font-size:0.98rem;margin-top:8px;">${v.fecha || ''}</div>
                </div>
                ${v.url ? `<a href="${v.url}" target="_blank" rel="noopener" class="job-card-apply job-card-apply-desktop">Postular</a>` : ''}
              </div>
              ${v.url ? `<a href="${v.url}" target="_blank" rel="noopener" class="job-card-apply job-card-apply-mobile">Postular</a>` : ''}
            `;
            container.appendChild(card);
          });
        }

        async function cargarVacantes() {
          const container = document.getElementById('vacantes-container');
          container.innerHTML = '<p style="text-align:center;">Cargando...</p>';
          try {
            if (SHEET_ID && SHEET_ID !== 'REEMPLAZAR_CON_TU_SHEET_ID' && SHEET_NAME) {
              const url = buildGvizUrl(SHEET_ID, SHEET_NAME);
              console.log('[Vacantes] Fetch gviz URL:', url);
              const res = await fetch(url, { cache: 'no-store' });
              if (!res.ok) throw new Error('HTTP ' + res.status);
              const text = await res.text();
              const rows = parseGvizJSON(text);
              if (!rows || rows.length === 0) throw new Error('GViz sin filas');
              renderVacantes(rows);
              return;
            }
          } catch (e) {
            console.warn('[Vacantes] Falla Google Sheets, usando CSV local:', e);
            try {
              const csvText = await fetch('vacantes.csv', { cache: 'no-store' }).then(r => r.text());
              const parsed = Papa.parse(csvText, { header: true, skipEmptyLines: true });
              renderVacantes(parsed.data || []);
              return;
            } catch (e2) {
              console.error('[Vacantes] Falla CSV local:', e2);
            }
          }
          container.innerHTML = '<p style="text-align:center;">No se pudo cargar la lista de vacantes.</p>';
        }

        cargarVacantes();
    });
    </script>
</body>
</html> 